# QDoctor Agent: System Documentation & Architecture

**Version:** 1.0  
**Date:** September 27, 2025  

---

This project provides a robust, production-ready AI agent designed to assist mental health professionals by answering questions based on a curated library of PDF documents.

It uses a Retrieval-Augmented Generation (RAG) architecture with a persistent vector store, a two-level semantic cache, and input/output guardrails for safety and reliability.

## Features

- **FastAPI Backend**: A high-performance web server for handling queries.
- **Persistent RAG**: Uses ChromaDB to store document embeddings, so data ingestion is a one-time process.
- **Semantic Caching**: A two-level cache (exact-match and semantic similarity) to provide instant answers to repeated or similar questions.
- **Safety Guardrails**: Validates and sanitizes both user input and LLM output to ensure safety and prevent data leakage.
- **Modular & Scalable**: The code is organized into logical services, making it easy to maintain and extend.
- **Powered by Groq**: Optimized for high-speed inference using the Groq LPUâ„¢.

## Setup Instructions

### 1. Project Structure

Ensure your project is organized with the following structure:

```
/mental_health_agent
|-- /app
|-- /scripts
|-- /pdfs/
|-- .env
|-- requirements.txt
|-- README.md
```

### 2. Create a Python Environment

It's highly recommended to use a virtual environment.

```bash
python -m venv venv
source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
```

### 3. Install Dependencies

Install all the required packages from the `requirements.txt` file.

```bash
pip install -r requirements.txt
```

### 4. Configure Environment Variables

Create a file named `.env` in the root of the project directory and add your Groq API key:

```
GROQ_API_KEY="your_groq_api_key_here"
```

### 5. Add PDF Documents

Place all your mental health PDF documents inside the `/pdfs` directory.

### 6. Ingest the Data (One-Time Step)

Run the ingestion script to process your PDFs and build the vector database. This only needs to be done once, or whenever you add/change the documents in the `/pdfs` folder.

```bash
python scripts/ingest.py
```
You will see output indicating the number of chunks indexed and that the database has been saved.

### 7. Run the Application Server

Start the FastAPI server using uvicorn.

```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```
The `--reload` flag is useful for development, as it automatically restarts the server when you make code changes.

### 8. Use the Agent

The API is now live. You can interact with it via its documentation, which is automatically generated by FastAPI.

- **Open your browser** and go to: `http://127.0.0.1:8000/docs`
- **Use the `/ask` endpoint**: Click on it, then "Try it out", enter your question, and execute.
